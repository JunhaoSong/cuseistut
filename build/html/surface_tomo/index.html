

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Surface Wave Tomography &mdash; CUSeisTut</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Ambient noise cross correlation" href="../ambient_tomo/index.html" />
    <link rel="prev" title="Body Wave Tomography" href="../body_tomo/index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> CUSeisTut
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">CUSeisTut</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/index.html">Introduction</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Entry level</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../unix/index.html">Unix commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GMT6-1/index.html">Generic Mapping Tools - Topographic Map</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GMT6-2/index.html">Generic Mapping Tools - Seismic Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../obspy-1/index.html">Seismic data request via ObsPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../obspy-2/index.html">Seismic data process via ObsPy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Intermediate level</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../sta_lta/index.html">Earthquake Detection STA/LTA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../abs_loc/index.html">Earthquake Absolute Location</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced level</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../gcap/index.html">Focal mechanism</a></li>
<li class="toctree-l1"><a class="reference internal" href="../eqt/index.html">Earthquake Transformer Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dd_loc/index.html">Double-Difference Earthquake Relocation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source_spectra/index.html">Spectral Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pylith_static/index.html">Static Stress Change - PyLith</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pylith_dynamic/index.html">Dynamic Rupture Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../body_tomo/index.html">Body Wave Tomography</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Surface Wave Tomography</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction-to-surface-waves">Introduction to surface waves</a></li>
<li class="toctree-l2"><a class="reference internal" href="#surface-waves-observations">Surface waves observations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#phase-shift-of-rayleigh-waves">Phase shift of Rayleigh waves</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dispersion-of-surface-waves">Dispersion of surface waves</a></li>
<li class="toctree-l2"><a class="reference internal" href="#compute-theoretical-dispersion-curve">Compute theoretical dispersion curve</a></li>
<li class="toctree-l2"><a class="reference internal" href="#invert-observed-dispersion-curve-for-1d-velocity">Invert observed dispersion curve for 1D velocity</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ambient_tomo/index.html">Ambient noise cross correlation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../appendix/index.html">Acknowledgement</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.google.com/forms/d/e/1FAIpQLScSQIcOtANjTonJDhK4KYmoA6H2lUHou9Mqz1oFCHSTd5wxhQ/viewform?usp=sf_link">Give us feedback here</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CUSeisTut</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Surface Wave Tomography</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/surface_tomo/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="surface-wave-tomography">
<h1>Surface Wave Tomography<a class="headerlink" href="#surface-wave-tomography" title="Permalink to this heading">¶</a></h1>
<section id="introduction-to-surface-waves">
<h2>Introduction to surface waves<a class="headerlink" href="#introduction-to-surface-waves" title="Permalink to this heading">¶</a></h2>
<p>Unlike body waves that travel through the earth’s interior, surface waves propagate along the earth’s surface. They could be generated from earthquakes and travel more slowly that body waves, but correspond to lower-frequency and higher amplitude in the seismogram. There are two most common types of surface waves in Seismology - Rayleigh waves and Love waves, which are named after their discoverers Lord Rayleigh and August Love.</p>
<p><strong>Rayleigh waves</strong> (or so called ground roll) move both longitudinally and horizontally and result in elliptical movement, similar to the rolling water waves but against the direction of propagation.</p>
<a class="reference internal image-reference" href="https://upload.wikimedia.org/wikipedia/commons/1/1e/Rayleigh_wave.jpg"><img alt="https://upload.wikimedia.org/wikipedia/commons/1/1e/Rayleigh_wave.jpg" src="https://upload.wikimedia.org/wikipedia/commons/1/1e/Rayleigh_wave.jpg" style="width: 90%;" /></a>
<p><strong>Love waves</strong> move horizontally and at the right angles to the direction of propagation, but cannot propagate in water like S-waves. The shear movement of the ground caused by Love waves is more damaging to the man-made structures.</p>
<a class="reference internal image-reference" href="https://upload.wikimedia.org/wikipedia/commons/thumb/2/29/Love_wave.svg/1920px-Love_wave.svg.png"><img alt="https://upload.wikimedia.org/wikipedia/commons/thumb/2/29/Love_wave.svg/1920px-Love_wave.svg.png" src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/29/Love_wave.svg/1920px-Love_wave.svg.png" style="width: 90%;" /></a>
</section>
<section id="surface-waves-observations">
<h2>Surface waves observations<a class="headerlink" href="#surface-waves-observations" title="Permalink to this heading">¶</a></h2>
<p>Here we provide example waveforms showing the surface waves generated from <code class="docutils literal notranslate"><span class="pre">2019</span> <span class="pre">M7.1</span> <span class="pre">Ridgecrest</span> <span class="pre">earthquake</span></code> recorded by <code class="docutils literal notranslate"><span class="pre">IU.HRV</span> <span class="pre">station</span> <span class="pre">located</span> <span class="pre">at</span> <span class="pre">Adam</span> <span class="pre">Dziewonski</span> <span class="pre">Observatory</span> <span class="pre">(Oak</span> <span class="pre">Ridge),</span> <span class="pre">Massachusetts,</span> <span class="pre">USA</span></code>.</p>
<p>For later use, please first download the <a class="reference download internal" download="" href="../_downloads/93cd80986a1f8f391b5059cedc7d41ad/2019-07-06-mw71-central-california-2.miniseed"><code class="xref download docutils literal notranslate"><span class="pre">waveform</span> <span class="pre">data</span></code></a> of miniSEED format into your local computer. Also make sure that ObsPy is also installed since it’s used for reading and processing waveforms.</p>
<p><strong>1. Import necessary modules or functions</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># from obspy modules import functions</span>
<span class="kn">from</span> <span class="nn">obspy</span> <span class="kn">import</span> <span class="n">read</span><span class="p">,</span> <span class="n">UTCDateTime</span>
<span class="kn">from</span> <span class="nn">obspy.geodetics.base</span> <span class="kn">import</span> <span class="n">gps2dist_azimuth</span>
<span class="kn">from</span> <span class="nn">obspy.core.stream</span> <span class="kn">import</span> <span class="n">Stream</span>
<span class="c1"># import matplotlib module</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<p><strong>2. Read the waveform data and only keep waveforms of location</strong> <code class="docutils literal notranslate"><span class="pre">10</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># read the downloaded waveforms into obspy stream object</span>
<span class="n">st</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="s1">&#39;./2019-07-06-mw71-central-california-2.miniseed&#39;</span><span class="p">)</span>
<span class="c1"># select traces whose location is &#39;10&#39;</span>
<span class="c1"># use copy function to aviod processing original stream</span>
<span class="n">st_10</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="s1">&#39;10&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1"># from the IRIS webpage about this instrument</span>
<span class="c1"># channel &#39;BH1&#39; azimuth and dip are 0 and 0</span>
<span class="c1"># channel &#39;BH2&#39; azimuth and dip are 90 and 0</span>
<span class="c1"># thus, we rename &#39;BH1&#39; into &#39;BHN&#39;</span>
<span class="c1"># and rename &#39;BH2&#39; into &#39;BHE&#39;</span>
<span class="c1"># this is useful for waveform rotation</span>
<span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">st_10</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">channel</span> <span class="o">==</span> <span class="s1">&#39;BH1&#39;</span><span class="p">:</span>
        <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">channel</span> <span class="o">=</span> <span class="s1">&#39;BHN&#39;</span>
    <span class="k">if</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">channel</span> <span class="o">==</span> <span class="s1">&#39;BH2&#39;</span><span class="p">:</span>
        <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">channel</span> <span class="o">=</span> <span class="s1">&#39;BHE&#39;</span>
<span class="c1"># quick check</span>
<span class="n">st_10</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/zne-waveforms.jpg"><img alt="../_images/zne-waveforms.jpg" src="../_images/zne-waveforms.jpg" style="width: 90%;" /></a>
<p><strong>3. Rotate waveforms from ZNE coordinate system into ZRT coordinate system</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># event info</span>
<span class="n">event_otime</span> <span class="o">=</span> <span class="n">UTCDateTime</span><span class="p">(</span><span class="s1">&#39;2019-07-06 03:19:53&#39;</span><span class="p">)</span>
<span class="n">event_longitude</span> <span class="o">=</span> <span class="o">-</span><span class="mf">117.599333</span>
<span class="n">event_latitude</span> <span class="o">=</span> <span class="mf">35.7695</span>
<span class="n">event_depth</span> <span class="o">=</span> <span class="mi">8</span> <span class="c1"># kilometer</span>
<span class="n">event_magnitude</span> <span class="o">=</span> <span class="mf">7.1</span>
<span class="c1"># station info</span>
<span class="n">station_longitude</span> <span class="o">=</span> <span class="o">-</span><span class="mf">71.5583</span>
<span class="n">station_latitude</span> <span class="o">=</span> <span class="mf">42.5064</span>
<span class="n">station_elevation</span> <span class="o">=</span> <span class="mf">200.0</span> <span class="c1"># meter</span>
<span class="n">station_depth</span> <span class="o">=</span> <span class="mf">0.0</span>
</pre></div>
</div>
<p>Compute necessary geometric parameters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># compute epicentral distance, azimuth, and back azimuth</span>
<span class="c1"># for this earthquake-station pair</span>
<span class="n">dist_in_m</span><span class="p">,</span> <span class="n">az</span><span class="p">,</span> <span class="n">baz</span> <span class="o">=</span> <span class="n">gps2dist_azimuth</span><span class="p">(</span><span class="n">event_latitude</span><span class="p">,</span> <span class="n">event_longitude</span><span class="p">,</span> <span class="n">station_latitude</span><span class="p">,</span> <span class="n">station_longitude</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;epicentral distance is: </span><span class="si">%.2f</span><span class="s1"> m&#39;</span><span class="o">%</span><span class="n">dist_in_m</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;azimuth is: </span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">az</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;back azimuth is: </span><span class="si">%.2f</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">baz</span><span class="p">)</span>
</pre></div>
</div>
<p>epicentral distance is: 3999969.28 m</p>
<p>azimuth is: 64.89</p>
<p>back azimuth is: 274.97</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># use the rotate function to rotate waveforms</span>
<span class="c1"># from ZNE coordinate system to ZRT coordinate system</span>
<span class="n">st_10</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="s1">&#39;NE-&gt;RT&#39;</span><span class="p">,</span> <span class="n">back_azimuth</span><span class="o">=</span><span class="n">baz</span><span class="p">)</span>
<span class="c1"># quick check</span>
<span class="c1"># Note that Love wave in the transverse component</span>
<span class="c1"># Rayleigh wave in the radial and vertical components</span>
<span class="n">st_10</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/zrt-waveforms.jpg"><img alt="../_images/zrt-waveforms.jpg" src="../_images/zrt-waveforms.jpg" style="width: 90%;" /></a>
<p>Clearly, We can see that surface waves arrive after the body waves and have much larger amplitude.</p>
</section>
<section id="phase-shift-of-rayleigh-waves">
<h2>Phase shift of Rayleigh waves<a class="headerlink" href="#phase-shift-of-rayleigh-waves" title="Permalink to this heading">¶</a></h2>
<p>Because Rayleigh waves correspond to elliptical movement in a vertical plane pointed in the direction in which the waves are travelling, thus the ground motions in radial and vertical directions should have phase shift.</p>
<p>Here we can apply a narrow bandpass filter to the waveforms and then plot them together to check the abovementioned phase shift phenomenon.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># first select vertical and radial components for analysis</span>
<span class="n">st_BHRZ</span> <span class="o">=</span> <span class="n">st_10</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;[RZ]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1"># remove mean, linear trend, and taper at both ends</span>
<span class="n">st_BHRZ</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="s1">&#39;demean&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">taper</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
<span class="c1"># apply a narrow bandpass filter to the raw waveform</span>
<span class="c1"># in this example: 8 s-12 s</span>
<span class="n">st_BHRZ</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s1">&#39;bandpass&#39;</span><span class="p">,</span> <span class="n">freqmin</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mf">12.</span><span class="p">,</span> <span class="n">freqmax</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mf">8.</span><span class="p">,</span> <span class="n">corners</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">zerophase</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># further zoom into the Rayleigh wave part</span>
<span class="n">st_ray</span> <span class="o">=</span> <span class="n">st_BHRZ</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">starttime</span><span class="o">=</span><span class="n">UTCDateTime</span><span class="p">(</span><span class="s1">&#39;2019-07-06 03:41:00&#39;</span><span class="p">),</span> <span class="n">endtime</span><span class="o">=</span><span class="n">UTCDateTime</span><span class="p">(</span><span class="s1">&#39;2019-07-06 03:42:30&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Exercise</strong>: try to change starttime and endtime to see if phase delay exists in other time windows.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot both traces together</span>
<span class="c1"># can you observe the phase shift?</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">st_ray</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="s2">&quot;matplotlib&quot;</span><span class="p">),</span> <span class="n">st_ray</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;b-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Radial&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">st_ray</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="s2">&quot;matplotlib&quot;</span><span class="p">),</span> <span class="n">st_ray</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;r-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis_date</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">autofmt_xdate</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/phase-delay.jpg"><img alt="../_images/phase-delay.jpg" src="../_images/phase-delay.jpg" style="width: 90%;" /></a>
</section>
<section id="dispersion-of-surface-waves">
<h2>Dispersion of surface waves<a class="headerlink" href="#dispersion-of-surface-waves" title="Permalink to this heading">¶</a></h2>
<p>Since longer period surface waves would penetrate deeper into higher speed layer, they will travel faster. As a result, velocities at a number of periods are different, this is so called surface wave dispersion.</p>
<p>For the sake of simplicity, here we only show the dispersion analysis of Love wave by applying few bandpass filters and measure the corresponding group velocity dispersion curve.</p>
<p><strong>1. select transverse component waveform and set several period bands</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># now only select transverse component for further analysis</span>
<span class="n">tr</span> <span class="o">=</span> <span class="n">st_10</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">component</span><span class="o">=</span><span class="s1">&#39;T&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># now choose a set of period bands</span>
<span class="c1"># and their units are in second</span>
<span class="n">period_bands</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">]]</span>
</pre></div>
</div>
<p><strong>2. save raw waveform into a stram and append filtered waveforms</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># first create an empty stream</span>
<span class="n">st_BHT</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">()</span>
<span class="c1"># the first trace is raw waveform without filtering</span>
<span class="n">st_BHT</span> <span class="o">+=</span> <span class="n">tr</span>
<span class="c1"># similar to the above loop except the last plot line is changed</span>
<span class="k">for</span> <span class="n">period_band</span> <span class="ow">in</span> <span class="n">period_bands</span><span class="p">:</span>
    <span class="n">freq_high</span><span class="p">,</span> <span class="n">freq_low</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">period_band</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">1.</span><span class="o">/</span><span class="n">period_band</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">tr_copy</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">tr_copy</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="s1">&#39;demean&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">taper</span><span class="p">(</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">tr_copy</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s1">&#39;bandpass&#39;</span><span class="p">,</span> <span class="n">freqmin</span><span class="o">=</span><span class="n">freq_low</span><span class="p">,</span> <span class="n">freqmax</span><span class="o">=</span><span class="n">freq_high</span><span class="p">,</span> <span class="n">corners</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">zerophase</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">st_BHT</span> <span class="o">+=</span> <span class="n">tr_copy</span>
<span class="c1"># then let&#39;s zoom-in</span>
<span class="n">st_BHT</span><span class="o">.</span><span class="n">trim</span><span class="p">(</span><span class="n">starttime</span><span class="o">=</span><span class="n">UTCDateTime</span><span class="p">(</span><span class="s1">&#39;2019-07-06 03:30:00&#39;</span><span class="p">),</span> <span class="n">endtime</span><span class="o">=</span><span class="n">UTCDateTime</span><span class="p">(</span><span class="s1">&#39;2019-07-06 03:50:00&#39;</span><span class="p">))</span>
<span class="c1"># quick plot with some newly arguments specified to make sure all traces share the same x-axis</span>
<span class="n">st_BHT</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">equal_scale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">automerge</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/disper-love.jpg"><img alt="../_images/disper-love.jpg" src="../_images/disper-love.jpg" style="width: 90%;" /></a>
<p><strong>3. measure group velocities at these periods</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. take 30 s to 40 s bandpass filtered waveform as an example</span>
<span class="n">data3040</span> <span class="o">=</span> <span class="n">st_BHT</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1"># ensure event original time corresponds to 0 s</span>
<span class="n">time3040</span> <span class="o">=</span> <span class="n">st_BHT</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">times</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="n">st_BHT</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span> <span class="o">-</span> <span class="n">event_otime</span><span class="p">)</span>
<span class="c1"># 2. perform Hilbert transform to get envelope (unnecessary to know details)</span>
<span class="n">envelope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">hilbert</span><span class="p">(</span><span class="n">data3040</span><span class="p">))</span>
<span class="c1"># 3. &quot;measure the time where largest amplitude observed&quot; - here for simplicity of analysis</span>
<span class="n">indexmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">envelope</span><span class="p">)</span>
<span class="n">travtime</span> <span class="o">=</span> <span class="n">time3040</span><span class="p">[</span><span class="n">indexmax</span><span class="p">]</span>
<span class="c1"># 4. compute group velocity by dividing distance by travel time</span>
<span class="n">velocity</span> <span class="o">=</span> <span class="n">dist_in_m</span> <span class="o">*</span> <span class="mf">0.001</span> <span class="o">/</span> <span class="n">travtime</span>
<span class="c1"># 5. print results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The distance is </span><span class="si">%.4f</span><span class="s1"> km, and travel time is </span><span class="si">%.2f</span><span class="s1"> s&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">dist_in_m</span> <span class="o">*</span> <span class="mf">0.001</span><span class="p">,</span> <span class="n">travtime</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Thus, the corresponding group velocity is </span><span class="si">%.4f</span><span class="s1"> km/s&#39;</span><span class="o">%</span><span class="n">velocity</span><span class="p">)</span>
<span class="c1"># simple plot using pyplot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time3040</span><span class="p">,</span> <span class="n">data3040</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time3040</span><span class="p">,</span> <span class="n">envelope</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">travtime</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">time3040</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">time3040</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
<p>The distance is 3999.9693 km, and travel time is 1121.84 s</p>
<p>Thus, the corresponding group velocity is 3.5655 km/s</p>
<a class="reference internal image-reference" href="../_images/group-measure.jpg"><img alt="../_images/group-measure.jpg" src="../_images/group-measure.jpg" style="width: 90%;" /></a>
<p><strong>4. repeat the above process for other period bands</strong></p>
<p>After changing to different period bands and re-run the step 3, we can get the following results:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>period</p></th>
<th class="head"><p>traveltime</p></th>
<th class="head"><p>velocity</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>10-20s</p></td>
<td><p>1175.52s</p></td>
<td><p>3.4027km/s</p></td>
</tr>
<tr class="row-odd"><td><p>20-30s</p></td>
<td><p>1157.97s</p></td>
<td><p>3.4543km/s</p></td>
</tr>
<tr class="row-even"><td><p>30-40s</p></td>
<td><p>1121.84s</p></td>
<td><p>3.5655km/s</p></td>
</tr>
<tr class="row-odd"><td><p>40-50s</p></td>
<td><p>1066.54s</p></td>
<td><p>3.7504km/s</p></td>
</tr>
</tbody>
</table>
<p><strong>5. plot the results</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now if we let each center period represent the period band</span>
<span class="n">center_periods</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">45</span><span class="p">]</span>
<span class="n">group_velocities</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.4027</span><span class="p">,</span> <span class="mf">3.4543</span><span class="p">,</span> <span class="mf">3.5655</span><span class="p">,</span> <span class="mf">3.7504</span><span class="p">]</span>
<span class="c1"># then show the period-velocity curve (i.e., dispersion curve)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">center_periods</span><span class="p">,</span> <span class="n">group_velocities</span><span class="p">,</span> <span class="s1">&#39;ks--&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Period (sec)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Group velocity (km/sec)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/disper-curve.jpg"><img alt="../_images/disper-curve.jpg" src="../_images/disper-curve.jpg" style="width: 90%;" /></a>
<p>Above all, this tutorial only gives a simple introduction to the ideas of surface waves and their dispersion, through which you may have a better understanding of surface waves.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Exercise</strong>: Search a teleseismic earthquake that can generate clear surface waves (<a class="reference external" href="http://ds.iris.edu/wilber3/find_event">http://ds.iris.edu/wilber3/find_event</a>) and finish the following tasks</p>
<ol class="arabic simple">
<li><p>Make a map view plot to show the position of the earthquake and the seismic station you chose. (refer to the GMT tutorial).</p></li>
<li><p>Request the seismograms at the station by Obspy (refer to the ObsPy tutorial).</p></li>
<li><p>Perform phase delay and dispersion analysis on the requested waveforms.</p></li>
</ol>
</div>
</section>
<section id="compute-theoretical-dispersion-curve">
<h2>Compute theoretical dispersion curve<a class="headerlink" href="#compute-theoretical-dispersion-curve" title="Permalink to this heading">¶</a></h2>
</section>
<section id="invert-observed-dispersion-curve-for-1d-velocity">
<h2>Invert observed dispersion curve for 1D velocity<a class="headerlink" href="#invert-observed-dispersion-curve-for-1d-velocity" title="Permalink to this heading">¶</a></h2>
</section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../ambient_tomo/index.html" class="btn btn-neutral float-right" title="Ambient noise cross correlation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../body_tomo/index.html" class="btn btn-neutral float-left" title="Body Wave Tomography" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021-2022, CUSeisTut team
      <span class="lastupdated">
        Last updated on 2022-11-23.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

  
  
    
   

</body>
</html>