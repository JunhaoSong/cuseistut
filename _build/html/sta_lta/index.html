<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Earthquake Detection STA/LTA &mdash; CUSeisTut</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Earthquake Absolute Location" href="../abs_loc/index.html" />
    <link rel="prev" title="Seismic data process via ObsPy" href="../obspy-2/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> CUSeisTut
          </a>
              <div class="version">
                0.0.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">CUSeisTut</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/index.html">Introduction</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Entry level</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../unix/index.html">Unix commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GMT6-1/index.html">Generic Mapping Tools - Topographic Map</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GMT6-2/index.html">Generic Mapping Tools - Seismic Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../obspy-1/index.html">Seismic data request via ObsPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../obspy-2/index.html">Seismic data process via ObsPy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Intermediate level</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Earthquake Detection STA/LTA</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#brief-introduction">Brief Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#why-do-we-use-sta-lta">Why do we use STA/LTA?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-does-sta-lta-works">How does STA/LTA works?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#aim-of-this-module">Aim of this Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#activate-obspy-environment">Activate ObsPy environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#import-necessary-packages">Import necessary packages</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#choose-an-event-and-read-the-waveform-data">1 Choose an Event and Read the Waveform Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#choose-an-event">1.1 Choose an event</a></li>
<li class="toctree-l3"><a class="reference internal" href="#choose-a-station-and-get-the-waveform">1.2 Choose a station and get the waveform</a></li>
<li class="toctree-l3"><a class="reference internal" href="#filter-data">1.3 Filter Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#triggering-example">1.4 Triggering Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-adjust-sta-lta-trigger-parameters">2 How to adjust STA/LTA trigger parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#selection-of-short-time-average-window-sta-duration">2.1 Selection of short-time average window (STA) duration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#selection-of-long-time-average-window-lta-duration">2.2 Selection of long-time average window (LTA) duration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#selection-of-sta-lta-trigger-threshold-level">2.3 Selection of STA/LTA trigger threshold level</a></li>
<li class="toctree-l3"><a class="reference internal" href="#selection-of-sta-lta-detrigger-threshold-level">2.4 Selection of STA/LTA detrigger threshold level</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#available-sta-lta-methods">3 Available STA/LTA Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#classic-sta-lta">3.1 Classic Sta Lta</a></li>
<li class="toctree-l3"><a class="reference internal" href="#recursive-sta-lta">3.2 Recursive Sta Lta</a></li>
<li class="toctree-l3"><a class="reference internal" href="#carl-sta-trig">3.3 Carl-Sta_Trig</a></li>
<li class="toctree-l3"><a class="reference internal" href="#delayed-sta-lta">3.4 Delayed Sta Lta</a></li>
<li class="toctree-l3"><a class="reference internal" href="#z-detect">3.5 Z-Detect</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#detect-events-on-multiple-traces-by-using-sta-lta">4 Detect events on multiple traces by using STA/LTA</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#get-the-waveform-data-with-more-than-1-station">4.1  Get the waveform data with more than 1 station</a></li>
<li class="toctree-l3"><a class="reference internal" href="#filter-the-data">4.2  Filter the data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-sta-lta-to-detect-events">4.2  Using STA/LTA to detect events</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../abs_loc/index.html">Earthquake Absolute Location</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced level</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../eqt/index.html">Earthquake Transformer Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dd_loc/index.html">Double-Difference Earthquake Relocation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source_spectra/index.html">Spectral Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pylith_static/index.html">Static Stress Change - PyLith</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pylith_dynamic/index.html">Dynamic Rupture Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../body_tomo/index.html">Body Wave Tomography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../surface_tomo/index.html">Surface Wave Tomography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ambient_tomo/index.html">Ambient noise cross correlation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../appendix/index.html">Acknowledgement</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.google.com/forms/d/e/1FAIpQLScSQIcOtANjTonJDhK4KYmoA6H2lUHou9Mqz1oFCHSTd5wxhQ/viewform?usp=sf_link">Give us feedback here</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CUSeisTut</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Earthquake Detection STA/LTA</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/sta_lta/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="earthquake-detection-sta-lta">
<h1>Earthquake Detection STA/LTA<a class="headerlink" href="#earthquake-detection-sta-lta" title="Permalink to this headline"></a></h1>
<p>Developer: Hui LIU, Earth Science System Program, CUHK</p>
<p>Testers: Zhangyu SUN &amp; Ng Kai Yin, Earth Science System Program, CUHK</p>
<section id="brief-introduction">
<h2>Brief Introduction<a class="headerlink" href="#brief-introduction" title="Permalink to this headline"></a></h2>
<section id="why-do-we-use-sta-lta">
<h3>Why do we use STA/LTA?<a class="headerlink" href="#why-do-we-use-sta-lta" title="Permalink to this headline"></a></h3>
<p>By introducing digital seismic data acquisition, long-term continuous recording and archiving of seismic signals has become a demanding technical problem. A seismic network or even a single seismic station operating continuously at high sampling frequency produces an enormous amount of data, which is often difficult to store (and analyze) locally or even at the recording center of a network. This situation has forced seismologists to invent triggered seismic data acquisition. In a triggered mode, a seismic station or a seismic network still processes all incoming seismic signals in real time (or in near-real-time) but incoming data is not stored continuously and permanently. Processing software - a trigger algorithm - serves for the detection of typical seismic signals (earthquakes, controlled source seismic signals, underground nuclear explosion signals, etc.) in the constantly present seismic noise signal. Once an assumed seismic event is detected, recording and storing of all incoming signals starts. It stops after the trigger algorithm ‘declares’ the end of the seismic signal.</p>
<p>The short-time-average/long-time-average <strong>STA/LTA</strong> trigger is usually used in weak-motion applications that try to record as many seismic events as possible. These are the applications where the <strong>STA/LTA</strong> algorithm is most useful. It is nearly a standard trigger algorithm in portable seismic recorders, as well as in many real time processing software packages of the weak-motion seismic networks. However, it may also be useful in many strong motion applications, except when interest is limited to the strongest earthquakes.</p>
</section>
<section id="how-does-sta-lta-works">
<h3>How does STA/LTA works?<a class="headerlink" href="#how-does-sta-lta-works" title="Permalink to this headline"></a></h3>
<p>The <strong>STA/LTA</strong> algorithm processes filter seismic signals in two moving time windows – a short-time average window
(STA) and a long-time average window (LTA). The STA measures the ‘instant’ amplitude of the seismic signal and watches for earthquakes. The LTA takes care of the current average seismic noise amplitude.</p>
<p>First, the absolute amplitude of each data sample of an incoming signal is calculated. Next, the average of absolute amplitudes in both windows is calculated. In a further step, a ratio of both values — STA/LTA ratio—is calculated. This ratio is continuously compared to a user selected threshold value - STA/LTA trigger threshold level. If the ratio exceeds this threshold, a channel trigger is declared. A channel trigger does not necessarily mean that a multi-channel
data logger or a network actually starts to record seismic signals. All seismic networks and most seismic recorders have a ‘trigger voting’ mechanism built in that defines how many and which channels have to be in a triggered state before the instrument or the network actually starts to record data. To simplify the explanation, we shall observe only one signal channel. We will assume that a channel trigger is equivalent to a network or a recorder trigger.</p>
<p>After the seismic signal gradually terminates, the channel detriggers. This happens when the current STA/LTA ratio falls below another user-selected parameter - STA/LTA detrigger threshold level. Obviously, the STA/LTA detrigger threshold level should be lower (or rarely equal) than the STA/LTA trigger threshold level.</p>
<p>In addition to the data acquired during the ‘trigger active’ time, seismic networks and seismic recorders add a certain amount of seismic data to the event file before triggering – pre-event-time (PEM) data. After the trigger active state terminates, they also add post-event-time (PET).
data.</p>
<p>For better understanding, Figure 1 shows a typical local event and the trigger variables (simplified) during STA/LTA triggering. Graph a) shows an incoming continuous seismic signal (filtered); graph b) shows an averaged absolute signal in the STA and LTA windows, respectively, as they move in time toward the right side of the graph; and graph c) shows the ratio of both. In addition, the trigger active state (solid line rectangle), the post-event time (PET), and the pre-event time (PEM) (dotted line rectangles) are shown. In this example, the trigger threshold level parameter was set to 10 and the detrigger threshold level to 2 (two short horizontal dotted lines). One can see that the trigger became active when the STA/LTA ratio value exceeded 10. It was deactivated when the STA/LTA ratio value fell below 2. On graph d) the actually recorded data file is shown. It includes all event phases of significance and a portion of the seismic noise at the beginning. In reality, the STA/LTA triggers are usually slightly more complicated, however, the details
are not essential for the understanding and proper setting of trigger parameters.</p>
<a class="reference internal image-reference" href="../_images/concept.png"><img alt="../_images/concept.png" src="../_images/concept.png" style="width: 80%;" /></a>
</section>
<section id="aim-of-this-module">
<h3>Aim of this Module<a class="headerlink" href="#aim-of-this-module" title="Permalink to this headline"></a></h3>
<p>The STA/LTA trigger parameter settings are always a tradeoff among several seismological and instrumental considerations. Successful capturing of seismic events depends on proper settings of the trigger parameters. To help with this task, this module explains the STA/LTA trigger functioning and gives general instructions on selecting its parameters. In addition, several different STA/LTA methods will also be introduced in this module.</p>
</section>
<section id="activate-obspy-environment">
<h3>Activate ObsPy environment<a class="headerlink" href="#activate-obspy-environment" title="Permalink to this headline"></a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<div class="line-block">
<div class="line">We here assume you have already installed ObsPy package in the opspy environment on your computer after finishing the previous <strong>Python ObsPy Tutorial</strong>.</div>
</div>
</div>
<p>Open your terminal and run the following commands.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda activate obspy
</pre></div>
</div>
</section>
<section id="import-necessary-packages">
<h3>Import necessary packages<a class="headerlink" href="#import-necessary-packages" title="Permalink to this headline"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">obspy.signal.trigger</span> <span class="kn">import</span> <span class="n">plot_trigger</span>
<span class="kn">from</span> <span class="nn">obspy.signal.trigger</span> <span class="kn">import</span> <span class="n">classic_sta_lta</span>
</pre></div>
</div>
</section>
</section>
<section id="choose-an-event-and-read-the-waveform-data">
<h2>1 Choose an Event and Read the Waveform Data<a class="headerlink" href="#choose-an-event-and-read-the-waveform-data" title="Permalink to this headline"></a></h2>
<section id="choose-an-event">
<h3>1.1 Choose an event<a class="headerlink" href="#choose-an-event" title="Permalink to this headline"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">obspy</span> <span class="kn">import</span> <span class="n">UTCDateTime</span>
<span class="n">origin_time</span> <span class="o">=</span> <span class="n">UTCDateTime</span><span class="p">(</span><span class="s2">&quot;2015-08-11T16:22:15.200000&quot;</span><span class="p">)</span>

<span class="c1"># Coordinates and the magnitude of the event</span>
<span class="n">eq_lon</span> <span class="o">=</span> <span class="mf">123.202</span>
<span class="n">eq_lat</span> <span class="o">=</span> <span class="o">-</span><span class="mf">8.624</span>
<span class="n">eq_dep</span> <span class="o">=</span> <span class="mf">171.9</span>
<span class="n">eq_mag</span> <span class="o">=</span> <span class="mf">3.9</span>
</pre></div>
</div>
</section>
<section id="choose-a-station-and-get-the-waveform">
<h3>1.2 Choose a station and get the waveform<a class="headerlink" href="#choose-a-station-and-get-the-waveform" title="Permalink to this headline"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">obspy.clients.fdsn</span> <span class="kn">import</span> <span class="n">Client</span>

<span class="c1"># IRIS is one of those providers.</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="s1">&#39;IRIS&#39;</span><span class="p">)</span>

<span class="c1"># Input station informations</span>
<span class="c1"># network</span>
<span class="n">net</span> <span class="o">=</span> <span class="s1">&#39;YS&#39;</span>
<span class="c1"># station</span>
<span class="n">sta</span> <span class="o">=</span> <span class="s1">&#39;BAOP&#39;</span>
<span class="c1"># location</span>
<span class="n">loc</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="c1"># channel</span>
<span class="n">cha</span> <span class="o">=</span> <span class="s1">&#39;BHZ&#39;</span>

<span class="c1"># starttime</span>
<span class="n">stt</span> <span class="o">=</span> <span class="n">origin_time</span>
<span class="c1"># endtime</span>
<span class="n">edt</span> <span class="o">=</span> <span class="n">origin_time</span> <span class="o">+</span> <span class="mi">120</span>

<span class="c1"># Get the waveforms from client</span>
<span class="n">st</span><span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_waveforms</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">sta</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">cha</span><span class="p">,</span> <span class="n">stt</span><span class="p">,</span> <span class="n">edt</span><span class="p">)</span>
<span class="n">st</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">st</span><span class="o">.</span><span class="n">spectrogram</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/singlechannel.png"><img alt="../_images/singlechannel.png" src="../_images/singlechannel.png" style="width: 80%;" /></a>
<a class="reference internal image-reference" href="../_images/spectrum.png"><img alt="../_images/spectrum.png" src="../_images/spectrum.png" style="width: 80%;" /></a>
</section>
<section id="filter-data">
<h3>1.3 Filter Data<a class="headerlink" href="#filter-data" title="Permalink to this headline"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># copy the raw data</span>
<span class="n">st2</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1"># apply the bandpass between 1.0HZ and 10.0HZ, in order to filter the noise.</span>
<span class="n">st2</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;bandpass&quot;</span><span class="p">,</span><span class="n">freqmin</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">freqmax</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
<span class="n">st2</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/filter.png"><img alt="../_images/filter.png" src="../_images/filter.png" style="width: 100%;" /></a>
</section>
<section id="triggering-example">
<h3>1.4 Triggering Example<a class="headerlink" href="#triggering-example" title="Permalink to this headline"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span>
<span class="c1"># set the STA=5 seconds, LTA=20 seconds</span>
<span class="n">cft</span> <span class="o">=</span> <span class="n">classic_sta_lta</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">df</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">20</span> <span class="o">*</span> <span class="n">df</span><span class="p">))</span>
<span class="c1"># set the trigger threshold=1.5, detrigger threshold=0.27</span>
<span class="n">plot_trigger</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cft</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/classic.png"><img alt="../_images/classic.png" src="../_images/classic.png" style="width: 70%;" /></a>
</section>
</section>
<section id="how-to-adjust-sta-lta-trigger-parameters">
<h2>2 How to adjust STA/LTA trigger parameters<a class="headerlink" href="#how-to-adjust-sta-lta-trigger-parameters" title="Permalink to this headline"></a></h2>
<p>To set the basic STA/LTA trigger algorithm parameters one has to select the following:</p>
<blockquote>
<div><div class="line-block">
<div class="line">1. <code class="docutils literal notranslate"><span class="pre">STA</span> <span class="pre">window</span> <span class="pre">duration</span></code></div>
<div class="line">2. <code class="docutils literal notranslate"><span class="pre">LTA</span> <span class="pre">window</span> <span class="pre">duration</span></code></div>
<div class="line">3. <code class="docutils literal notranslate"><span class="pre">STA/LTA</span> <span class="pre">trigger</span> <span class="pre">threshold</span> <span class="pre">level</span></code></div>
<div class="line">4. <code class="docutils literal notranslate"><span class="pre">STA/LTA</span> <span class="pre">detrigger</span> <span class="pre">threshold</span> <span class="pre">level</span></code></div>
</div>
</div></blockquote>
<section id="selection-of-short-time-average-window-sta-duration">
<h3>2.1 Selection of short-time average window (STA) duration<a class="headerlink" href="#selection-of-short-time-average-window-sta-duration" title="Permalink to this headline"></a></h3>
<p>Short-time average window measures the ‘instant’ value of a seismic signal or its envelope. Generally, STA duration must be longer than a few periods of a typically expected seismic signal. If the STA is too short, the averaging of the seismic signal will not function properly. The STA is no longer a measure of the average signal (signal envelope) but becomes influenced by individual periods of the seismic signal. On the other hand, STA duration must be shorter than the shortest events we expect to capture.</p>
<p>The STA can be considered as a signal filter. The shorter the duration selected, the higher the trigger’s sensitivity to short lasting local earthquakes compared to long lasting and lower frequency distant earthquakes. The longer the STA duration selected, the less sensitive it is for short local earthquakes. Therefore, by changing the STA duration one can prioritize capturing of distant or local events.</p>
<p>For regional events, a typical value of STA duration is between 1 and 2 sec. For local earthquakes shorter values around 0.5 to 0.3 s are commonly used in practice.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span>
<span class="c1"># only set different short-time average window (STA) durations</span>
<span class="c1"># sta=5 seconds</span>
<span class="n">cft</span> <span class="o">=</span> <span class="n">classic_sta_lta</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">df</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">20</span> <span class="o">*</span> <span class="n">df</span><span class="p">))</span>
<span class="n">plot_trigger</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cft</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">)</span>
<span class="c1"># sta=0.5 seconds, represents a smaller value</span>
<span class="n">cft</span> <span class="o">=</span> <span class="n">classic_sta_lta</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">df</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">20</span> <span class="o">*</span> <span class="n">df</span><span class="p">))</span>
<span class="n">plot_trigger</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cft</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">)</span>
<span class="c1"># sta=10 seconds, represents a larger value</span>
<span class="n">cft</span> <span class="o">=</span> <span class="n">classic_sta_lta</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">df</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">20</span> <span class="o">*</span> <span class="n">df</span><span class="p">))</span>
<span class="n">plot_trigger</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cft</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/sta.png"><img alt="../_images/sta.png" src="../_images/sta.png" style="width: 70%;" /></a>
</section>
<section id="selection-of-long-time-average-window-lta-duration">
<h3>2.2 Selection of long-time average window (LTA) duration<a class="headerlink" href="#selection-of-long-time-average-window-lta-duration" title="Permalink to this headline"></a></h3>
<p>The LTA window measures average amplitude seismic noise. It should last longer than a few ‘periods’ of typically irregular seismic noise fluctuations. By changing the LTA window duration, one can make the recording more or less sensitive to regional events in the ‘Pn’-wave range from about 200 to 1500 km epicentral distance. These events typically have the low-amplitude emergent Pn- waves as the first onset. A short LTA duration allows the LTA value more or less to adjust to the slowly increasing amplitude of emergent seismic waves. Thus the STA/LTA ratio remains low in spite of increasing STA (nominator and denominator of the ratio increase). This effectively diminishes trigger sensitivity to such events. In the opposite case, using a long LTA window duration, trigger sensitivity to the emergent earthquakes is increased because the LTA value is not so rapidly influenced by the emergent seismic signal, allowing Sg/Lg waves to trigger the recording.</p>
<p>The LTA duration of 60 seconds is a common initial value. A shorter LTA duration is needed to exclude emergent regional events from triggering, if desired, or if quickly changing manmade noise is typical for the site. A longer LTA can be used for distant regional events with very long S-P times and potentially emergent P waves.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># only set different long-time average window (STA) durations</span>
<span class="c1"># lta=20 seconds</span>
<span class="n">cft</span> <span class="o">=</span> <span class="n">classic_sta_lta</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">df</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">20</span> <span class="o">*</span> <span class="n">df</span><span class="p">))</span>
<span class="n">plot_trigger</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cft</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">)</span>
<span class="c1"># lta=10 seconds, represents a smaller value</span>
<span class="n">cft</span> <span class="o">=</span> <span class="n">classic_sta_lta</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">df</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">df</span><span class="p">))</span>
<span class="n">plot_trigger</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cft</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">)</span>
<span class="c1"># lta=50 seconds, represents a larger value</span>
<span class="n">cft</span> <span class="o">=</span> <span class="n">classic_sta_lta</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">df</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">50</span> <span class="o">*</span> <span class="n">df</span><span class="p">))</span>
<span class="n">plot_trigger</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cft</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/lta.png"><img alt="../_images/lta.png" src="../_images/lta.png" style="width: 70%;" /></a>
</section>
<section id="selection-of-sta-lta-trigger-threshold-level">
<h3>2.3 Selection of STA/LTA trigger threshold level<a class="headerlink" href="#selection-of-sta-lta-trigger-threshold-level" title="Permalink to this headline"></a></h3>
<p>The STA/LTA trigger threshold level to the greatest extent determines which events will be recorded and which will not. The higher value one sets, the more earthquakes will not be recorded, but the fewer false-triggers will result. The lower the STA/LTA trigger threshold level is selected, the more sensitive the seismic station will be and the more events will be recorded. However, more frequent false triggers also will occupy data memory and burden the analyst. An optimal STA/LTA trigger threshold level depends on seismic noise conditions at the site and on one’s tolerance to falsely triggered records. Not only the amplitude but also the type of seismic noise influence the setting of the optimal STA/LTA trigger threshold level. A statistically stationary seismic noise (with less irregular fluctuations) allows a lower STA/LTA trigger threshold level; completely irregular behavior of seismic noise demands higher values.</p>
<p>An initial setting for the STA/LTA trigger threshold level of 4 is common for an average quiet seismic site. Much lower values can be used only at the very best station sites with no man- made seismic noise. Higher values about 8 and above are required at less favorable sites with significant man-made seismic noise. In strong-motion applications, higher values are more common due to the usually noisier seismic environment and generally smaller interest in weak events.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cft</span> <span class="o">=</span> <span class="n">classic_sta_lta</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">df</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">20</span> <span class="o">*</span> <span class="n">df</span><span class="p">))</span>
<span class="c1"># only set different STA/LTA trigger threshold levels</span>
<span class="c1"># STA/LTA trigger threshold = 1.5</span>
<span class="n">plot_trigger</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cft</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">)</span>
<span class="c1"># STA/LTA trigger threshold = 0.5, represents a small trigger threshold value</span>
<span class="n">plot_trigger</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cft</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">)</span>
<span class="c1"># STA/LTA trigger threshold = 4, represents a large trigger threshold value</span>
<span class="n">plot_trigger</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cft</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/trigger.png"><img alt="../_images/trigger.png" src="../_images/trigger.png" style="width: 70%;" /></a>
</section>
<section id="selection-of-sta-lta-detrigger-threshold-level">
<h3>2.4 Selection of STA/LTA detrigger threshold level<a class="headerlink" href="#selection-of-sta-lta-detrigger-threshold-level" title="Permalink to this headline"></a></h3>
<p>The STA/LTA detrigger threshold level determines the termination of data recording. To include as much of the coda waves as possible, a low value is required. If one uses coda duration for magnitude determinations, such setting is obvious. However, a too low STA/LTA detrigger threshold level is occasionally dangerous. It may cause very long or even endless records, for example, if a sudden increase in seismic noise does not allow the STA/LTA ratio to fall below the STA/LTA detrigger threshold level. On the other hand, if one is not interested in coda waves, a higher value of STA/LTA detrigger threshold level enables significant savings in data memory and/or data transmission time. Note that coda waves of distant earthquakes can be very long.</p>
<p>A typical initial value of the STA/LTA detrigger threshold level is 2 to 3 for seismically quiet sites and weak motion applications. For noisier sites, higher values must be set. For strong- motion applications, where coda waves are not of the highest importance, higher values are frequently used.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cft</span> <span class="o">=</span> <span class="n">classic_sta_lta</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">df</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">20</span> <span class="o">*</span> <span class="n">df</span><span class="p">))</span>
<span class="c1"># only set different STA/LTA detrigger threshold levels</span>
<span class="c1"># STA/LTA trigger threshold = 1.5</span>
<span class="n">plot_trigger</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cft</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">)</span>
<span class="c1"># STA/LTA detrigger threshold = 0.1, represents a small trigger threshold value</span>
<span class="n">plot_trigger</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cft</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="c1"># STA/LTA detrigger threshold = 1, represents a large trigger threshold value</span>
<span class="n">plot_trigger</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cft</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/detrigger.png"><img alt="../_images/detrigger.png" src="../_images/detrigger.png" style="width: 70%;" /></a>
</section>
</section>
<section id="available-sta-lta-methods">
<h2>3 Available STA/LTA Methods<a class="headerlink" href="#available-sta-lta-methods" title="Permalink to this headline"></a></h2>
<a class="reference internal image-reference" href="../_images/available_methods.png"><img alt="../_images/available_methods.png" src="../_images/available_methods.png" style="width: 100%;" /></a>
<section id="classic-sta-lta">
<h3>3.1 Classic Sta Lta<a class="headerlink" href="#classic-sta-lta" title="Permalink to this headline"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># we already import the classic_sta_lta at the begining.</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span>
<span class="c1"># set the STA=5 seconds, LTA=20 seconds</span>
<span class="n">cft</span> <span class="o">=</span> <span class="n">classic_sta_lta</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">df</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">20</span> <span class="o">*</span> <span class="n">df</span><span class="p">))</span>
<span class="c1"># set the trigger threshold=1.5, detrigger threshold=0.27</span>
<span class="n">plot_trigger</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cft</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/classic.png"><img alt="../_images/classic.png" src="../_images/classic.png" style="width: 70%;" /></a>
</section>
<section id="recursive-sta-lta">
<h3>3.2 Recursive Sta Lta<a class="headerlink" href="#recursive-sta-lta" title="Permalink to this headline"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">obspy.signal.trigger</span> <span class="kn">import</span> <span class="n">recursive_sta_lta</span>
<span class="c1"># set the STA=5 seconds, LTA=23 seconds</span>
<span class="n">cft</span> <span class="o">=</span> <span class="n">recursive_sta_lta</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">df</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">23</span> <span class="o">*</span> <span class="n">df</span><span class="p">))</span>
<span class="c1"># set the trigger threshold=1.5, detrigger threshold=0.27</span>
<span class="n">plot_trigger</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cft</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.27</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/recursive.png"><img alt="../_images/recursive.png" src="../_images/recursive.png" style="width: 70%;" /></a>
</section>
<section id="carl-sta-trig">
<h3>3.3 Carl-Sta_Trig<a class="headerlink" href="#carl-sta-trig" title="Permalink to this headline"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">obspy.signal.trigger</span> <span class="kn">import</span> <span class="n">carl_sta_trig</span>
<span class="c1"># set the STA=5 seconds, LTA=20 seconds</span>
<span class="n">cft</span> <span class="o">=</span> <span class="n">carl_sta_trig</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">df</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">20</span> <span class="o">*</span> <span class="n">df</span><span class="p">),</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="c1"># set the trigger threshold=20, detrigger threshold=-50.0</span>
<span class="n">plot_trigger</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cft</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">50.0</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/carl.png"><img alt="../_images/carl.png" src="../_images/carl.png" style="width: 70%;" /></a>
</section>
<section id="delayed-sta-lta">
<h3>3.4 Delayed Sta Lta<a class="headerlink" href="#delayed-sta-lta" title="Permalink to this headline"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">obspy.signal.trigger</span> <span class="kn">import</span> <span class="n">delayed_sta_lta</span>
<span class="c1"># set the STA=5 seconds, LTA=20 seconds</span>
<span class="n">cft</span> <span class="o">=</span> <span class="n">delayed_sta_lta</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">df</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">20</span> <span class="o">*</span> <span class="n">df</span><span class="p">))</span>
<span class="c1"># set the trigger threshold=1.5, detrigger threshold=12</span>
<span class="n">plot_trigger</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cft</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/delayed.png"><img alt="../_images/delayed.png" src="../_images/delayed.png" style="width: 70%;" /></a>
</section>
<section id="z-detect">
<h3>3.5 Z-Detect<a class="headerlink" href="#z-detect" title="Permalink to this headline"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">obspy.signal.trigger</span> <span class="kn">import</span> <span class="n">z_detect</span>
<span class="c1"># set the LTA=10 seconds</span>
<span class="n">cft</span> <span class="o">=</span> <span class="n">z_detect</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">df</span><span class="p">))</span>
<span class="c1"># set the trigger threshold=-0.2, detrigger threshold=0</span>
<span class="n">plot_trigger</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cft</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/zdetect.png"><img alt="../_images/zdetect.png" src="../_images/zdetect.png" style="width: 70%;" /></a>
</section>
</section>
<section id="detect-events-on-multiple-traces-by-using-sta-lta">
<h2>4 Detect events on multiple traces by using STA/LTA<a class="headerlink" href="#detect-events-on-multiple-traces-by-using-sta-lta" title="Permalink to this headline"></a></h2>
<section id="get-the-waveform-data-with-more-than-1-station">
<h3>4.1  Get the waveform data with more than 1 station<a class="headerlink" href="#get-the-waveform-data-with-more-than-1-station" title="Permalink to this headline"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up a list for bulk request</span>
<span class="n">bulk</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;YS&#39;</span><span class="p">,</span> <span class="s1">&#39;BAOP&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;BHZ&#39;</span><span class="p">,</span> <span class="n">origin_time</span><span class="p">,</span> <span class="n">origin_time</span><span class="o">+</span><span class="mi">120</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;YS&#39;</span><span class="p">,</span> <span class="s1">&#39;HADA&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;BHZ&#39;</span><span class="p">,</span> <span class="n">origin_time</span><span class="p">,</span> <span class="n">origin_time</span><span class="o">+</span><span class="mi">120</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;YS&#39;</span><span class="p">,</span> <span class="s1">&#39;SINA&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;BHZ&#39;</span><span class="p">,</span> <span class="n">origin_time</span><span class="p">,</span> <span class="n">origin_time</span><span class="o">+</span><span class="mi">120</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;YS&#39;</span><span class="p">,</span> <span class="s1">&#39;ALRB&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;BHZ&#39;</span><span class="p">,</span> <span class="n">origin_time</span><span class="p">,</span> <span class="n">origin_time</span><span class="o">+</span><span class="mi">120</span><span class="p">)]</span>

<span class="n">st_bulk</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_waveforms_bulk</span><span class="p">(</span><span class="n">bulk</span><span class="p">)</span>
<span class="n">st_bulk</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/bulk.png"><img alt="../_images/bulk.png" src="../_images/bulk.png" style="width: 70%;" /></a>
</section>
<section id="filter-the-data">
<h3>4.2  Filter the data<a class="headerlink" href="#filter-the-data" title="Permalink to this headline"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># make a copy of raw data</span>
<span class="n">st2</span> <span class="o">=</span> <span class="n">st_bulk</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1"># apply the bandpass</span>
<span class="n">st2</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s1">&#39;bandpass&#39;</span><span class="p">,</span><span class="n">freqmin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">freqmax</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">st2</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/bulk_filter.png"><img alt="../_images/bulk_filter.png" src="../_images/bulk_filter.png" style="width: 70%;" /></a>
</section>
<section id="using-sta-lta-to-detect-events">
<h3>4.2  Using STA/LTA to detect events<a class="headerlink" href="#using-sta-lta-to-detect-events" title="Permalink to this headline"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># we already import the classic_sta_lta at the begining.</span>
<span class="c1"># set a loop to detect the events using STA/LTA, the classic_sta_lta method is used here.</span>
<span class="c1"># you can try other STA/LTA methods and find the differences</span>
<span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">st2</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span>
    <span class="n">cft</span> <span class="o">=</span> <span class="n">classic_sta_lta</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">6</span> <span class="o">*</span> <span class="n">df</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">20</span> <span class="o">*</span> <span class="n">df</span><span class="p">))</span>
    <span class="n">plot_trigger</span><span class="p">(</span><span class="n">tr</span><span class="p">,</span> <span class="n">cft</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/bulk_detect1.png"><img alt="../_images/bulk_detect1.png" src="../_images/bulk_detect1.png" style="width: 70%;" /></a>
<a class="reference internal image-reference" href="../_images/bulk_detect2.png"><img alt="../_images/bulk_detect2.png" src="../_images/bulk_detect2.png" style="width: 70%;" /></a>
<a class="reference internal image-reference" href="../_images/bulk_detect3.png"><img alt="../_images/bulk_detect3.png" src="../_images/bulk_detect3.png" style="width: 70%;" /></a>
<a class="reference internal image-reference" href="../_images/bulk_detect4.png"><img alt="../_images/bulk_detect4.png" src="../_images/bulk_detect4.png" style="width: 70%;" /></a>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../obspy-2/index.html" class="btn btn-neutral float-left" title="Seismic data process via ObsPy" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../abs_loc/index.html" class="btn btn-neutral float-right" title="Earthquake Absolute Location" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2022, CUSeisTut team.
      <span class="lastupdated">Last updated on 2022-04-27.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>